% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/file_tibble.R
\name{xlr8_read_folder}
\alias{xlr8_read_folder}
\title{Read and Extract Structured Data from Excel Files in a Folder}
\usage{
xlr8_read_folder(
  path,
  recursive = FALSE,
  filter_out_tilda = TRUE,
  sheets = NULL,
  sheet_regex = ".",
  extract = TRUE
)
}
\arguments{
\item{path}{Character. Folder path to search for Excel files.}

\item{recursive}{Logical. Whether to search subdirectories recursively. Default is `FALSE`.}

\item{filter_out_tilda}{Logical. Whether to exclude files with a tilde (`~`) in the name. Default is `TRUE`.}

\item{sheets}{Optional character vector specifying exact sheet names to read. Passed to `read_excel_all()`.}

\item{sheet_regex}{Regular expression to match sheet names if `sheets` is `NULL`. Default is `"."`.}

\item{extract}{Logical. Whether to extract structured data using `xlr8_read()`. If `FALSE`, only metadata is attached.}
}
\value{
A tibble where each row represents a processed Excel file. Columns include:
\describe{
  \item{file}{File name.}
  \item{path}{Full file path.}
  \item{raw_df}{Raw data read from the Excel file (nested).}
  \item{form_name}{Form name extracted from the hidden "form" sheet.}
  \item{form_metadata}{Metadata tibble for the form (nested), if found in the database.}
  \item{...}{If `extract = TRUE`, additional columns for each variable/table defined in the form metadata. Tables are nested tibbles.}
}
}
\description{
Scans a folder for `.xlsx` files, reads them using `read_excel_all()`,
extracts the form version from each file, retrieves corresponding metadata
from the `form_metadata` database table, and optionally extracts structured data
using `xlr8_read()`.
}
\details{
- Excel files must include a hidden sheet named `"form"` with a version string (e.g., `"my_form_v0001"`) in cell A1.
- Metadata must be stored in a database table named `"form_metadata"` (populated via `summarize_metadata()`).
- Progress bars are shown if `.progress` is used (requires `purrr >= 1.0.0`).
}
