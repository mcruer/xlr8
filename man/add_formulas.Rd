% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/add_formulas.R
\name{add_formulas}
\alias{add_formulas}
\title{Write Formulas to an Excel Workbook}
\usage{
add_formulas(wb, df, all_info)
}
\arguments{
\item{wb}{A `wbWorkbook` object loaded with `openxlsx2::wb_load()`.}

\item{df}{A data frame of structured input data, where list-columns contain table-like tibbles.}

\item{all_info}{A tibble of metadata (from `summarize_metadata()`) that includes
positioning, structure, and `formula_to_write` values.}
}
\value{
The modified workbook object with formulas written in place.
}
\description{
Inserts formulas into an Excel workbook using metadata-defined positions. This function
shifts formulas as needed (e.g., for column-based replication) and writes them using
`openxlsx2::wb_add_formula()`.
}
\details{
It assumes that the input metadata has been enriched with a `formula_to_write` column,
typically via `summarize_metadata()` which processes embedded Excel template tags.
}
\examples{
\dontrun{
wb <- openxlsx2::wb_load("template.xlsx")
metadata <- summarize_metadata("template.xlsx")
df <- tibble::tibble(
  summary_table = list(tibble::tibble(score = 1:3))
)
wb <- add_formulas(wb, df, metadata$all_info[[1]])
openxlsx2::wb_save(wb, "with_formulas.xlsx", overwrite = TRUE)
}

}
