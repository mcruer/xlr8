% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/helpers.R
\name{shift_formula_references}
\alias{shift_formula_references}
\title{Shift Cell References in Excel Formulas}
\usage{
shift_formula_references(
  formula,
  source_row,
  source_col,
  target_row,
  target_col
)
}
\arguments{
\item{formula}{Character vector of Excel formulas.}

\item{source_row}{Integer vector of row positions where each formula originally resided.}

\item{source_col}{Integer vector of column positions where each formula originally resided.}

\item{target_row}{Integer vector of row positions where the formula is being moved to.}

\item{target_col}{Integer vector of column positions where the formula is being moved to.}
}
\value{
A character vector of formulas with shifted cell references, aligned with their new positions.
}
\description{
Given an Excel formula and a change in location (source â†’ target cell), this function
adjusts all relative cell references to reflect the new position, while preserving absolute references.
}
\details{
This is useful when copying formulas between cells and wanting to simulate Excel's built-in reference shifting logic.
It handles single-cell references, ranges (e.g., \code{A1:B2}), and complex expressions (e.g., \code{=IF(A1>0, B1, C1)}).
}
\examples{
shift_formula_references("=A$1+$B2", source_row = 1, source_col = 1, target_row = 3, target_col = 3)
# Returns: "=C$1+$B4"

}
