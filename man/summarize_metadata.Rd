% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/summarize_metadata.R
\name{summarize_metadata}
\alias{summarize_metadata}
\title{Summarize Metadata Directly from an Excel Template File}
\usage{
summarize_metadata(metadata_path, sheets = NULL, sheets_regex = ".")
}
\arguments{
\item{metadata_path}{File path to the Excel template workbook.}

\item{sheets}{Optional character vector specifying exact sheet names to read.
Defaults to \code{NULL}, in which case sheets matching \code{sheets_regex} are read.}

\item{sheets_regex}{Regular expression pattern to select sheets when \code{sheets} is \code{NULL}.
Defaults to \code{"."}, matching all sheets.}
}
\value{
A tibble containing structured metadata organized into four list-columns:
  \itemize{
    \item \code{variable_info}: Metadata describing individual cells (variables), including:
      \itemize{
        \item \code{sheet_name}: Sheet where variable is located.
        \item \code{row_start}, \code{col_start}: Position (row and column) of the variable.
        \item \code{tbl}: Name assigned to the variable.
      }

    \item \code{table_info}: Metadata summarizing each table identified in the Excel template, including:
      \itemize{
        \item \code{sheet_name}: Sheet name containing the table.
        \item \code{tbl}: Table name extracted from metadata tags.
        \item \code{row_start}, \code{row_end}: Row range of the table.
        \item \code{col_start}, \code{col_end}: Column range of the table.
      }

    \item \code{column_info}: Metadata detailing columns within each table, including:
      \itemize{
        \item \code{sheet_name}: Sheet name containing the column.
        \item \code{tbl}: Associated table name.
        \item \code{col}: Column position relative to its table (starting from 1).
        \item \code{col_name}: Name assigned to the column.
      }

    \item \code{all_info}: Combined metadata tibble containing both variable and column information
      suitable for subsequent data-writing and styling functions.
  }
}
\description{
Reads an Excel template file and summarizes structured metadata tags embedded in the sheets,
extracting comprehensive details about variables, tables, and column definitions.
This function is a convenient wrapper around \code{read_excel_all()} followed by internal metadata parsing.
}
\details{
The Excel template must have metadata annotations embedded using a predefined format (\code{xlr8_tag}),
which enables the structured identification of variables, tables, and columns. Specifically, this function:

\itemize{
  \item Extracts metadata from single-cell variables indicated by tags like \code{*((var*((...))}.
  \item Identifies tables by start/end markers like \code{*((tbl*((...))} and \code{*((table_end}.
  \item Extracts column definitions within tables using \code{*((col*((...))} tags.
}

The function performs extensive internal checks for errors such as misaligned columns or incomplete metadata.
If misalignments or other issues are detected, the function stops execution and provides clear, explicit
error messages to facilitate correction.

Users who require separate control over reading Excel sheets and summarizing metadata
can independently use \code{read_excel_all()} and internal summarization functions.
}
\examples{
\dontrun{
metadata <- summarize_metadata("template.xlsx")
metadata$table_info  # View detailed table metadata
metadata$variable_info  # Inspect extracted variable metadata
}

}
